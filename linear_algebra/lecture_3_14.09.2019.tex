\section{Лекция 3}

$Ax = b, A \in \text{Mat}_{m \times n}, b \in \RR^m$

Полная информация о СЛУ содержится в её \textit{расширенной матрице} $(A | b)$.

\begin{definition}
    Две системы уравнений от одних и тех же неизвестных называются \textit{эквивалентными}, если они имеют одинаковые множества решений.
\end{definition}

\begin{example}
    Рассмотрим несколько СЛУ

    \begin{enumerate}[label=\Alph*)]
    \item
        $\begin{cases}
            x_1 + x_2 = 1 \\
            x_1 - x_2 = 0
        \end{cases}$

        $\begin{pmatrix}
            1 & 1 & 1 \\
            1 & -1 & 0
        \end{pmatrix}$

    \item
        $\begin{cases}
            2x_1 = 1 \\
            2x_2 = 1
        \end{cases}$

        $\begin{pmatrix}
            2 & 0 & 1 \\
            0 & 2 & 1
        \end{pmatrix}$

    \item
        $x_1 + x_2 = 1$
        
        $\begin{pmatrix} 1 & 1 & 1 \end{pmatrix}$
    \end{enumerate}

    A и B эквиваленты, так как обе имеют единственное решение $(\frac{1}{2}, \frac{1}{2})$.
    
    A и C не эквивалентны, так как C имеет бесконечно много решений.
\end{example}

\subsection{Как решить СЛУ?}

\textbf{Идея}: выполнить преобразование СЛУ, сохраняющее множество её решений, и привести её к такому виду, в котором СЛУ легко решается.

\begin{example}
    $\begin{pmatrix}
        1 & 0 & \dots & 0 \\
        0 & 0 & \dots & 0 \\
        \vdots & \vdots & \ddots & \vdots \\
        0 & 0 & \dots & 1
    \end{pmatrix} \leftrightarrow \begin{cases}
        x_1 = b_1 \\
        x_2 = b_2 \\ 
        \vdots \\ 
        x_n = b_n
    \end{cases}$
\end{example}

\subsubsection{Элементарные преобразования СЛУ и её расширенная матрица}

\begin{tabular}{c|c|c}
    тип & СЛУ & расширенная матрица \\
    \hline
    1. & K $i$-му уравнению прибавить $j$-ое, умноженное на $\lambda \in \RR(i \neq j)$ & $\text{Э}_1(i, j, \lambda)$ \\
    2. & Переставить $i$-е и $j$-е уравнения $(i \neq j)$ & $\text{Э}_2(i, j)$ \\
    3. & Умножить $i$-ое уравнение на $\lambda \neq 0$ & $\text{Э}_3(i, \lambda)$
\end{tabular}

\begin{enumerate}
\item
    $\text{Э}_1(i, j, \lambda):$ к $i$-ой строке прибавить $j$-ую, умноженную на $\lambda$ (покомпонентно), 

    $a_{ik} \to a_{ik} + \lambda a_{jk} \forall k = 1, \dots, n,$
    $b_i \to b_i + \lambda b_j$.
    
\item
    $\text{Э}_2(i, j):$ переставить i-ую и j-ую строки.

\item
    $\text{Э}_3(i, \lambda):$ умножить i-ю строку на $\lambda$ (покомпонентно).
\end{enumerate}

$\text{Э}_1, \text{Э}_2, \text{Э}_3$ называются \textit{элементарными преобразованиями строк расширенной матрицы}.

\begin{lemma}
    Элементарные преобразоывания СЛУ не меняют множество решений
\end{lemma}

\begin{proof}
    Пусть мы получили СЛУ$(\star\star)$ из СЛУ($\star$) путем элементарных преобразований.

    \begin{enumerate}
    \item
        Всякое решение системы $(\star)$ является решением $(\star\star)$.
    \item
        $(\star)$ получается из $(\star\star)$ путем элементарных пробразований.

        \begin{tabular}{c|c|}
            $(\star) \to (\star\star)$ & $(\star\star) \to (\star)$ \\
            \hline
            $\text{Э}_1(i, j, \lambda)$ & $\text{}_2(i, j, \lambda)$ \\
            $\text{Э}_2(i, j)$ & $\text{}_2(i, j)$ \\
            $\text{Э}_3(i, \lambda)$ & $\text{}_3(i, \frac{1}{\lambda})$
        \end{tabular}
    \end{enumerate} 

    Следовательно, всякое решение ($\star\star$) является решением ($\star$) $\implies$ множества решений совпадают.
\end{proof}

\subsection{Ступенчатые матрицы}

\begin{definition}
    \textit{Ведущим элементом} ненулевой строки называется первый её ненулевой элемент.
\end{definition}

\begin{definition}
    Матрица $M \in \text{Mat}_{m \times n}$ называется ступенчатой, или имеет ступенчатый вид, если:
    \begin{enumerate}
    \item Номера ведущих элементов её ненулевых строк строго возрастают.
    \item Все нулевые строки стоят в конце.
    \end{enumerate}
\end{definition}
\begin{equation*}
    M = \begin{pmatrix}
        0 & \dots & 0 & \diamond & * & * & * & * & * & * \\
        0 & \dots & 0 & 0 & \dots & \diamond & * & * & * & * \\
        0 & \dots & 0 & 0 & \dots & 0 & 0 & \diamond & * & * \\
        \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\
        0 & 0 & 0 & \dots & \dots & \dots & \dots & 0 & \diamond & * \\
        0 & 0 & 0 & \dots & 0 & 0 & 0 & 0 & 0 & 0
    \end{pmatrix}
.\end{equation*}
$\diamond \neq 0$, $*$ -- что угодно. 

\begin{definition}
    M имеет \textit{улучшенный ступенчатый вид}, если:

    \begin{enumerate}
    \item M имеет обычный ступенчатый вид.
    \item Все ведущие элементы равны 1.
    \item В одном столбце с любым ведущим элементом стоят только нули.
    \end{enumerate}
\end{definition}

\begin{equation*}
    M = \begin{pmatrix}
        0 & \dots & 0 & 1 & * & 0 & * & 0 & 0 & * \\
        0 & \dots & 0 & 0 & \dots & 1 & * & 0 & 0 & * \\
        0 & \dots & 0 & 0 & \dots & 0 & 0 & 1 & 0 & * \\
        \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\
        0 & 0 & 0 & \dots & \dots & \dots & \dots & 0 & 1 & * \\
        0 & 0 & 0 & \dots & 0 & 0 & 0 & 0 & 0 & 0
    \end{pmatrix}
.\end{equation*}

\begin{theorem}
    \begin{enumerate*}[label=\arabic*)]
    \item Всякую матрицу элементарными преобразованиями можно привести к ступенчатому виду.
    \item Всякую ступенчатую матрицу элементарными преобразованиями строк можно привести к улучшенному ступенчатому виду.
    \end{enumerate*}
\end{theorem}

\begin{consequence}
    Всякую матрицу элементарными преобразованиями строк можно привести к улучшенному ступенчатому виду.
\end{consequence}

\begin{proof}~
    \begin{enumerate}
    \item
        Алгоритм. Если M - нулевая, то конец. Иначе:
        \begin{enumerate}[label=Шаг \arabic*]
        \item Ищем первый ненулевой столбец, пусть $j$ --- его номер.
        \item Переставляем строки, если нужно, добиваемся того, что $a_{1j} \neq 0$
        \item 
            Выполняем $\text{}_1(2, 1, -\frac{a_{2j}}{a_{1j}}, \dots, \text{}_1(m, 1, -\frac{a_{mj}}{a_{1j}})$.
            В результате $a_{ij} = 0$ при $i = 2, 3, \dots m$.
        \end{enumerate}
        Дальше все повторяем для меньшей матрицы $M'$.
    \item 
        Алгоритм. Пусть $a_{1j_1}, a_{2j_2}, \dots, a_{rj_r}$ -- ведущие элементы слупенчатой матрицы.
        \begin{enumerate}[label=Шаг \arabic*]
        \item Выполняем $\text{}_3(1, \frac{1}{a_{1j_1}}), \dots, \text{}_3(r, \frac{1}{a_{rj_r}})$, в результате все ведущие элементы равны 1.
        \item Выполнив $\text{}_1(r - 1, r, -a_{r - 1 \ j_r}), \text{}_1(r - 2, r, -a_{r - 2 \ j_r}), \dots, \text{}_1(1, r, -a_{1 \ j_r})$. В результате все элементы над $a_{r j_r}$ равны 0.
        \end{enumerate}
        Аналогично обнуляем элементы над всеми остальными ведущими.
    \end{enumerate}
    Итог: матрица имеет улучшенный ступенчатый вид.
\end{proof}

\subsection{Применение элементарных преобразований СЛУ к матрицам}


Всякое элементарное преобразование строк матрицы реализуется умножением как умножение слева на подходящую ``элементарную матрицу''.


$\text{Э}_1(i, j, \lambda): A \to U_1(i, j, \lambda)A$, где
\[ 
    U = \begin{pmatrix} govno \end{pmatrix}
\]

(на диагонали стоят единицы, на $i$-м $j$-м месте стоит $\lambda$, остальные элементы нули)

$\text{Э}_2(i, j): A \to U_2(i, j)A$, где
\[
    U_2(i, j) = \begin{pmatrix} zhopa \end{pmatrix}
\]

(на диагонали стоят единицы, кроме $i$-го и $j$-го столбца (там нули, на $i$-м $j$-м и $j$-м $i$-м местах стоит 1, остальные нули)

$\text{Э}_3(i, \lambda): A \to U_3(i, \lambda)A$, где
\[
    U_3(i, \lambda) = \begin{pmatrix} her \end{pmatrix}
\]

(на диагонали стоят единицы, кроме i-го столбца, там $\lambda$, остальные элементы нули)

\begin{exercise}
    Доказательство.
\end{exercise}

\begin{exercise}
    Элементарные преобразования столбцов.
\end{exercise}

